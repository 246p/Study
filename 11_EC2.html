<!DOCTYPE html>
<html>
<head>
<title>11_EC2.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<p><a href="https://arxiv.org/pdf/2208.14530.pdf">MC2: Rigorous and Effeicient Directed Greybox Fuzzing</a></p>
<h1 id="abstract">Abstract</h1>
<ul>
<li>ê¸°ì¡´ DGFëŠ” performanceë‚˜ optimalityì— ëŒ€í•œ ì´ë¡ ì  ë¶„ì„ì„ ì œê³µí•˜ì§€ ì•ŠìŒ</li>
<li>DGFë¥¼ oracle-guided serach probremìœ¼ë¡œ ì„¤ì •í•˜ëŠ” complexity-theoritic framworkë¥¼ ì œì‹œ</li>
<li>input spaceì— ëŒ€í•œ feedback (ex distance)ë¥¼ oracleì—ê²Œ ë¬¼ì–´ë³¸ë‹¤.</li>
<li>targetì— ë„ë‹¬í•˜ëŠ” inputì„ ì°¾ê¸° ìœ„í•œ oracle queryì˜ ìˆ˜ë¥¼ performance metricìœ¼ë¡œ ì‚¬ìš©</li>
<li>ê°€ëŠ¥í•œ inputì˜ ìˆ˜ì˜ log scaleì— í•´ë‹¹í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ê³  ìµœì ì„ì„ ì¦ëª…</li>
<li><em>MC2</em>ì— ì´ë¥¼ êµ¬í˜„</li>
</ul>
<h1 id="1-introduction">1. Introduction</h1>
<ul>
<li>ê¸°ì¡´ì—ëŠ” CFG distance, branch constraint distanceì„ ì‚¬ìš©</li>
<li>ì´ëŠ” ì§ê´€ì´ë‚˜ ê²½í—˜ì  ì¦ê±° (í•™ë¬¸ì  ë¶„ì„ì´ ì—†ìŒ)</li>
<li>computational complexitytheoretic framework ì œì‹œ</li>
</ul>
<h1 id="11-complexity-theoretic-framework">1.1. Complexity-Theoretic Framework</h1>
<ul>
<li>DGFì˜ complexity-theoretic formulationë¥¼ ì œì‹œ</li>
<li>instrumentation typeë° fuzzing algorithm ì— ëŒ€í•œ ì„¸ë¶€ ì‚¬í•­ì„ ì¶”ìƒí™” í•˜ì—¬ framworkë¡œ ì „í™˜</li>
<li>DGF -&gt; oracle-guided serach problemìœ¼ë¡œ ëª¨ë¸ë§</li>
<li>oracleì€ serach spaceì— ëŒ€í•œ ì •ë³´ë¥¼ fuzzing algorithmì—ê²Œ ì•Œë ¤ì£¼ì–´ target reached inputì„ ì°¾ìŒ</li>
<li>í”„ë¡œê·¸ë¨ì˜ ë™ì‘ì´ë‚˜ input/ouput ë¶„í¬ì— ëŒ€í•œ ê°€ì •ì„ í•˜ì§€ ì•ŠìŒ</li>
<li>oralceì´ ì¿¼ë¦¬ë‹¹ í¬ì§€ë§Œ ì¼ì •í•œ ì–‘ì˜ ì •ë³´ë¥¼ ê°€ì§„ ë‚´ìš©ì„ ë°˜í™˜í•˜ë„ë¡í•¨</li>
</ul>
<h2 id="12-execution-complexity">1.2. Execution Complexity</h2>
<ul>
<li>
<p>target siteì— ë„ë‹¬í• ë•Œê¹Œì§€ oralceì—ê²Œ ë³´ë‚´ëŠ” ì¿¼ë¦¬ì˜ ìˆ˜ë¡œ performance ë¥¼ ì¸¡ì •</p>
</li>
<li>
<p>ìš°ë¦¬ì˜ complexity metricì€ oracleì„ í†µí•´ quantum algorithmì˜ quantum ë¶€ë¶„ê³¼ classical partë¥¼ ë¶„ë¦¬í•¨</p>
</li>
<li>
<p>query complexity : ì–´ë–¤ ì•Œê³ ë¦¬ì¦˜ì´ ì£¼ì–´ì§„ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•˜ì—¬ ì–¼ë§ˆë‚˜ ë§ì€ì€ ì§ˆë¬¸ì„ í•´ì•¼ í•˜ëŠ”ê°€ &gt; ì´ë¥¼ ì´ìš©í•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ì˜ í•˜í•œì„ ì„ ì •í•  ìˆ˜ ìˆê³  ì–¼ë§ˆë‚˜ íš¨ìœ¨ì ì¸ì§€ ì •ëŸ‰ì ìœ¼ë¡œ í‰ê°€í•  ìˆ˜ ìˆë‹¤.</p>
</li>
</ul>
<p><a href="https://eccc.weizmann.ac.il/report/2021/115/">On Quantum Versus Classical Query Complexity</a></p>
<blockquote>
<p>ë‹¨ í•˜ë‚˜ë„ ì´í•´í•˜ì§€ ëª»í•˜ì˜€ë‹¤.</p>
</blockquote>
<p><a href="https://eta.impa.br/dl/043.pdf">Understanding Quantum Algorithms via Query Complexity</a></p>
<blockquote>
<p>ì–‘ì ì•Œê³ ë¦¬ì¦˜ì´ ë¬´ì—‡ì¸ì§€ ì„¤ëª…</p>
</blockquote>
<ul>
<li>feedback informationì— ëŒ€í•œ lower boundë¥¼ íƒêµ¬í•˜ì—¬ ì´ë¥¼ ìµœëŒ€í•œ í™œìš©í•˜ëŠ” adaptive algorithmì„ ì„¤ê³„í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•¨</li>
</ul>
<h2 id="13-an-optimal-fuzzing-algorithm">1.3. An Optimal Fuzzing Algorithm</h2>
<ul>
<li><em>noisy counting oracle</em>ì„ ë„ì…í•¨</li>
<li>ì´ëŠ” ë‘ input spaceë¥¼ ì—ì„œ ê° ì˜ì—­ì—ì„œ target siteë¡œ ë„ë‹¬í•˜ëŠ” ì…ë ¥ì„ ëŒ€ëµì ìœ¼ë¡œ ê³„ì‚°í•˜ê³  ë” ë†’ì€ ìˆ˜ë¥¼ ê°€ì§„ ì˜ì—­ì´ ë” ìœ ë§í•œê²ƒìœ¼ë¡œ íŒë‹¨í•˜ê³  ì´ë¥¼ ë°˜í™˜í•œë‹¤. (p&lt;0.5ì˜ í™•ë¥ ë¡œ ê±°ì§“ì„ ë°˜í™˜í•˜ëŠ” Monte Carlo counting algorithm)</li>
</ul>
<p>ì‹œê°„ ë³µì¡ë„ : $O({{log(N)} \over {(0.5-p)^2}})$ &gt; ì´ëŠ” ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ê³„ì„ ë  ìˆ˜ ì—†ìŒì„ ì¦ëª…</p>
<ul>
<li>ìš°ë¦¬ì˜ fuzzing algorithmì€ ë” ë†’ì€ ìˆ˜ì˜ ì˜ì—­ì„ ì„ íƒí•˜ê³  Binary search ë¡œ ìœ ë§í•œ ì˜ì—­ì„ ì¢í˜€ê°€ëŠ” counting oracleì„ ì‚¬ìš©</li>
<li>í•˜ì§€ë§Œ ì–´ë–¤ input spaceê°€ ë” í° ìˆ˜ë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì‹ í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ noiseì— ê°•í•´ì•¼ í•œë‹¤.</li>
<li>ë”°ë¼ì„œ noisy binary search algorithmì„ ì‚¬ìš©í•˜ì˜€ë‹¤.</li>
<li>ê° spaceì— ê°€ì¤‘ì¹˜ ì§‘í•©ì„ ì‚¬ìš©í•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ì˜ ì •í™•ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. &gt; ì¦‰ ì›í•˜ëŠ” inputì´ í•´ë‹¹ ì˜ì—­ì— ì¡´ì¬í•  ê°€ëŠ¥ì„±ì„ ë‚˜íƒ€ëƒ„</li>
<li>ì•Œê³ ë¦¬ì¦˜ì€ ê° oracle queryì— ê¸°ë°˜í•˜ì—¬ ìœ ë§í•œ ì˜ì—­ì˜ ê°€ì¤‘ì¹˜ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì¦ê°€ì‹œí‚¤ë©° ìœ ë§í•œ input sapceë¥¼ ì¢í˜€ë‚˜ê°„ë‹¤.</li>
</ul>
<h2 id="14-approximate-counting-with-monte-carlo">1.4. Approximate Counting with Monte Carlo</h2>
<ul>
<li>noisy counting oracleì„ êµ¬í˜„í•˜ê¸°ìœ„í•˜ì—¬ Monte Carlo algorithm ì‚¬ìš©</li>
<li>Monte Carlo random samplingì€ ì‹¤ì œ ê°’ì´ 0ì´ ì•„ë‹Œ ì‘ì€ ìˆ˜ì´ë”ë¼ë„ ëŒ€ë¶€ë¶„ì˜ ê·¼ì‚¬ ê³„ì‚°ì´ 0ì´ ë  ìˆ˜ ìˆë‹¤.</li>
<li>input spaceì—ì„œ target reach inputì˜ ìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒë„ ë§¤ìš° ì‘ì€ í™•ë¥ ì´ê¸°ì— 0ìœ¼ë¡œ ê³„ì‚°ëœë‹¤.</li>
<li>ì´ ë¬¸ì œë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ ìš°ë¦¬ëŠ” ëª©í‘œì— ë„ë‹¬í•  ìˆ˜ ìˆëŠ” inputì„ ì°¾ì§€ ëª»í•˜ë”ë¼ë„ ë” ë†’ì€ í™•ì‹ ì„ ê°€ì§€ê³  ê³„ì‚°ì— ëŒ€í•œ ìƒí•œì„ ì„ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤ëŠ”ê²ƒì„ ê´€ì°°í•˜ì˜€ë‹¤.</li>
</ul>
<h2 id="15-concentration-bounds">1.5. Concentration Bounds</h2>
<ul>
<li>concentration boundë¥¼ ì´ìš©í•¨ &gt; í‰ê· ê³¼ ë¶„ì‚°ì— ê¸°ë°˜í•˜ì—¬ ëœë¤ í•¨ìˆ˜ê°€ íŠ¹ì • ê°’ì„ ê°€ì§ˆ í™•ë¥ ì˜ ìƒí•œì„ ì •í•˜ëŠ” ë°©ë²•</li>
<li>branch constraintì˜ distanceë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëª¨ë¸ë§ í•˜ë©´ ë¬´ì‘ìœ„ë¡œ ì„ íƒëœ ì…ë ¥ìœ¼ë¡œ í‰ê· ê³¼ ë¶„ì‚°ì„ ê³„ì‚°í•˜ë©´ ì´ branchë¥¼ ë§Œì¡±í•  ê°€ëŠ¥ì„±ì— ëŒ€í•œ ìƒí•œì„ êµ¬í•  ìˆ˜ ìˆë‹¤.
í•˜ì§€ë§Œ ì´ëŠ” over approximateë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤. &gt; ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•˜ì—¬ ë‹¨ì¼ oracle queryë¥¼ ìˆ˜í–‰í• ë•Œ ì–´ë–¤ inputì— ëŒ€í•´ì„œë„ ë§Œì¡±ëœì  ì—†ëŠ” branchì— ëŒ€í•´ì„œë§Œ ìƒí•œì„ ì ìš©í•œë‹¤. ë‚˜ë¨¸ì§€ì— ëŒ€í•´ì„œëŠ” branchë¥¼ ë§Œì¡±ì‹œí‚¤ëŠ” inputì˜ ìˆ˜ì™€ ì´ ì…ë ¥ìˆ˜ì˜ ê²½í—˜ì§ ë¹„ìœ¨ì„ ì‚¬ìš©í•¨</li>
</ul>
<h2 id="16-counting-along-multiple-branches">1.6. Counting along Multiple Branches</h2>
<ul>
<li>ê° branchë¥¼ ë§Œì¡±ì‚¬ëŠ” inputì˜ ìˆ˜ë¥¼ ê·¼ì‚¬í•˜ê³  ì´ë¥¼ í†µí•´ ëª©í‘œì— ë„ë‹¬í•˜ëŠ” ì…ë ¥ì— ìˆ˜ì— ëŒ€í•œ ì¶”ì •ì¹˜ë¥¼ ì–»ëŠ”ë‹¤. <a href="#24-noisy-counting-oracle-through-monte-carlo-counting">2.4ì ˆ</a></li>
<li>Monte Carlo Executionn : runtimeì— control flowë¥¼ ìˆ˜ì •í•˜ì—¬ ì™¸ë¶€ branch constraintë¥¼ ë§Œì¡±í•˜ì§€ ì•Šë”ë¼ë„ ë‚´ë¶€ branchì— ë°©ë¬¸í•˜ë„ë¡ í•¨</li>
<li>ì´ë¥¼ í†µí•´ ì†Œìˆ˜ì˜ í”„ë¡œê·¸ë¨ ì‹¤í–‰ìœ¼ë¡œ ê·¼ì‚¬í•  ìˆ˜ ìˆìŒ</li>
<li>MC2(Monte Carlo Counting)ì„ êµ¬í˜„í•¨</li>
</ul>
<p><img src="./image//11_figure1.png" alt="figure1"></p>
<h2 id="17-contributions">1.7. contributions</h2>
<ul>
<li>DGFë¥¼ oracle-guided serach problemìœ¼ë¡œ ì •ì˜í•˜ëŠ” complexity-theoretic frameworkë¥¼ ì†Œê°œ, ì•Œê³ ë¦¬ì¦˜ì˜ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ëŠ” metricì¸ execution complexityë¥¼ ë„ì…í•¨</li>
<li>ê°€ëŠ¥í•œ inputì˜ ìˆ˜ì— logarithmicí•œ execution complexityë¥¼ ê°–ëŠ” DGFë¥¼ ì„¤ê³„í•˜ì˜€ë‹¤.</li>
<li>noisy counting oracleì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ Monte Carlo algorithmì„ êµ¬í˜„</li>
</ul>
<h1 id="2-methodology">2. Methodology</h1>
<h2 id="21-terminology-and-notation">2.1. Terminology and Notation</h2>
<ul>
<li>fuzzer = DGF</li>
<li>P = target program</li>
<li>I = ìœ í•œí•œ input space</li>
<li>|Â·| = cardinality</li>
</ul>
<h3 id="211-input-region">2.1.1. Input Region</h3>
<ul>
<li>WLOG. target program's input space = hyperrectangle I = [0,255]^d, dëŠ” input byte</li>
</ul>
<h3 id="212-control-flow-graph">2.1.2. Control Flow Graph</h3>
<ul>
<li>CFG=(V, E), V = BB, E = control-flow transition (ex branch)</li>
<li>path $\pi$ = finite sequence of edge int CFG $\pi$ : $E_0 \rightarrow  E_1 \rightarrow ... \rightarrow E_k $</li>
</ul>
<h3 id="213-branch-constraint">2.1.3. Branch Constraint</h3>
<ul>
<li>CFGì—ì„œ ê° edgeëŠ” branch constraintì— í•´ë‹¹í•¨</li>
<li>$c:I\rightarrow{0,1}$</li>
<li>d(i) : branch distance</li>
</ul>
<blockquote>
<p>Constraint c(i) := d(i) âŠ³âŠ² 0</p>
</blockquote>
<blockquote>
<p>Predicate âŠ³âŠ² := {==,&lt;,&lt;=,&gt;,&gt;=}</p>
</blockquote>
<blockquote>
<p>Input i := [$i_1, i_2, ..., i_d$ ]</p>
</blockquote>
<h2 id="22-a-framework-for-directed-greybox-fuzzing">2.2. A Framework for Directed Greybox Fuzzing</h2>
<ul>
<li>ì‹¤í—˜ì ì¸ ì¸¡ì •ì€ ì´ìƒì ì¸ fuzzerì— ì–¼ë§ˆë‚˜ ê°€ê¹Œìš´ì§€ ì•Œë ¤ì£¼ì§€ ëª»í•¨</li>
<li>program execution íšŸìˆ˜ ì¸¡ë©´ì—ì„œ ì´ìƒì ì¸ fuzzerì˜ ì„±ëŠ¥ì— ëŒ€í•œ í•˜í•œì„ ì„ ì¶”ë¡ í•˜ê¸° ìœ„í•œ complexity theoretic framework ì†Œê°œ</li>
</ul>
<h3 id="221-fuzzing-as-oracle-guided-search">2.2.1. Fuzzing as Oracle-Guided Search</h3>
<ul>
<li>ìš°ë¦¬ì˜ framworkëŠ” fuzzerê°€ oracleì— query í•˜ì—¬ input space I ì— ëŒ€í•œ ì •ë³´ë¥¼ í•™ìŠµ</li>
<li>oracle $ O : I \rightarrow {0,1}^c$ , c bitì˜ì¼ì •í•œ í¬ê¸°ì˜ ì •ë³´ë¥¼ ë°˜í™˜í•œë‹¤.</li>
<li><a href="#23-optimal-directed-fuzzer-with-noisy-counting-oracle">2.3</a>ì ˆì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´ fuzzerëŠ” inputì˜ í¬ê¸°ë¥¼ $1\over{2^c}$ë¡œ ì¤„ì¼ ìˆ˜ ìˆìŒ</li>
<li>ì‹¤ì œ fuzzerë“¤ì€ simbolic/concolic executionì´ ëª¨ë“  path constraintë¥¼ ìˆ˜ì§‘í•˜ê³  SMTë¥¼ í˜¸ì¶œí•˜ëŠ”ê²ƒê³¼ ë‹¬ë¦¬ ìµœì†Œí•œì˜ execution overheadë¥¼ ìœ„í•˜ì—¬ ligth-weight í•œë‹¤.</li>
<li>ì´ì™€ ìœ ì‚¬í•œ ë§¥ë½ìœ¼ë¡œ cë¥¼ ìƒìˆ˜ë¡œ ì •í•œê²ƒì€ ì í•©í•˜ë‹¤.</li>
<li>ì´ framworkë¥¼ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•˜ì—¬ target programì˜ í–‰ë™ì´ë‚˜ input typeì— ëŒ€í•œ ê°€ì • ì—†ì´ distribution-freeí•˜ê²Œ ì‘ë™í•œë‹¤. ë˜í•œ fuzzerê°€ í”„ë¡œê·¸ë¨ì— ëŒ€í•œ ì‚¬ì „ ì§€ì‹ ì—†ì´ oracle queryë¥¼ í†µí•´ ì •ë³´ë¥¼ ì–»ëŠ”ë‹¤ê³  ê°€ì •í•œë‹¤.</li>
</ul>
<h3 id="222-problem-definition">2.2.2. Problem Definition</h3>
<ul>
<li>DGFë¥¼ oracle-guided search problemìœ¼ë¡œ ì •ì˜í•¨</li>
<li>$P, CFG, I, E_T, O:I \rightarrow {0.1}^c$ë¥¼ ì´ìš©í•˜ì—¬ $E_T$ì— ë„ë‹¬í•˜ëŠ” $i\in I$ë¥¼ ì°¾ì•„ì•¼ í•¨</li>
</ul>
<h3 id="223-execution-complexity">2.2.3. Execution Complexity</h3>
<ul>
<li>fuzzerì˜ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ê¸° ìœ„í•˜ì—¬ search problemì„ í•´ê²°í•˜ê¸° ìœ„í•œ oracleì˜ queryì˜ ìˆ˜ë¥¼ ë¶„ì„í•œë‹¤.</li>
<li>oracle queryì˜ ìˆ˜ëŠ” program execution ìˆ˜ì— ì§ì ‘ mapping ë˜ê¸° ë•Œë¬¸ì— fuzzerì˜ ì„±ëŠ¥ì„ execution complexityë¡œ ì •ì˜í•œë‹¤.</li>
<li>ì´ë¥¼ ì´ìš©í•˜ì—¬ ì´ìƒì ì¸ fuzzerì— ëŒ€í•´ ì¶”ë¡ í•  ìˆ˜ ìˆë‹¤. ì¦‰ ì–´ë–¤ fuzzerì˜ ì„±ëŠ¥ì— ëŒ€í•œ í•˜í•œì„ ì„ ì œê³µí•œë‹¤.</li>
</ul>
<h4 id="theorem-21-lower-bound-for-any-fuzzing-algorithm">Theorem 2.1 (Lower Bound for Any Fuzzing Algorithm)</h4>
<p>queryë‹¹ C bitì˜ ì •ë³´ë¥¼ ë“œëŸ¬ë‚´ëŠ” oracleì´ ì£¼ì–´ì¡Œì„ë•Œ fuzzing algorithmë„ Ní¬ê¸°ì˜ input spaceì—ì„œ ëª©í‘œì— ë„ë‹¬í•˜ëŠ” ì…ë ¥ì„ ì°¾ê¸° ìœ„í•´ì„œ $\Omega(log(N))$ì˜ execution complexityê°€ í•„ìš”í•˜ë‹¤.</p>
<h3 id="224-greybox-vs-blackbox-oracle">2.2.4. Greybox vs Blackbox Oracle</h3>
<ul>
<li>Blackbox oracleì„ ì´ìš©í•˜ì—¬ lower boundì— ë„ë‹¬í•  ìˆ˜ ì—†ë‹¤. ì—¬ê¸°ì„œ oracle queryëŠ” ì£¼ì–´ì§„ ëª©í‘œê°€ ë„ë‹¬í–ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” bool valueë§Œ ì¶œë ¥í•œë‹¤. ì¦‰ fuzzerê°€ ê³ ë ¤í•˜ëŠ” inputì˜ ìˆ˜ë¥¼ 1ë§Œí¼ ê°ì†Œì‹œí‚¨ë‹¤. ì¦‰ O(N)ì˜ ì‹¤í–‰ ë³µì¡ë„ë¥¼ ê°–ëŠ”ë‹¤.</li>
</ul>
<h2 id="23-optimal-directed-fuzzer-with-noisy-counting-oracle">2.3. Optimal Directed Fuzzer with Noisy Counting Oracle</h2>
<ul>
<li>noisy counting oracle : ì„ì˜ì˜ ë‘ input sapceì¤‘ì—ì„œ targetì— ë„ë‹¬í•˜ëŠ” inputì˜ ìˆ˜ë¥¼ ëŒ€ëµì ìœ¼ë¡œ ê³„ì‚°í•˜ì—¬ ì–´ëŠ ì˜ì—­ì´ ë” ìœ ë§í•˜ëŠ”ì§€ ì‹ë³„</li>
<li>ì´ìƒì ì´ í™˜ê²½ì—ì„œ noiseê°€ ì—†ëŠ” counting oracleì„ ì„¤ëª…í•œ í›„ noisyê°€ ìˆëŠ”ê²ƒì„ ì‚¬ìš©í•˜ëŠ” í˜„ì‹¤ì ì¸ ì„¤ì •ìœ¼ë¡œ í™•ì¥</li>
</ul>
<h3 id="231-noisy-counting-oracle">2.3.1. Noisy Counting Oracle</h3>
<ul>
<li>noisy counting oracle : ëª©í‘œì— ë„ë‹¬í•˜ëŠ” inputì´ ë” ë§ì€ spaceì— ëŒ€í•´ c=1 bitì˜ ì •ë³´ë¥¼ ë°˜í™˜</li>
<li>p&lt;0.5ì˜ í™•ë¥ ë¡œ ì˜ëª»ëœ ë‹µì„ ë°˜í™˜í•œë‹¤ê³  ê°€ì •, input space $I_L, I_R$ì— ëŒ€í•´ ë‹¤ìŒ ê³µì‹ì„ ê³„ì‚°</li>
<li>C(I) = input space Iì— ì†í•œ inputì¤‘ targetì— ë„ë‹¬í•œ ì¸í’‹</li>
</ul>
<p><img src="./image/11_formula1.png" alt="formula1"></p>
<p><img src="./image/11_formula2.png" alt="formula2"></p>
<h3 id="232-optimal-deterministic-fuzzer">2.3.2. Optimal Deterministic Fuzzer</h3>
<ul>
<li>ì´ìƒì ì¸ í™˜ê²½ì—ì„œ noiseê°€ ì—†ëŠ” (p=0) counting oracleì„ ì‚¬ìš©í•˜ì—¬ ìµœì ì˜ execution complexityë¥¼ ë‹¬ì„±í•˜ëŠ” ê²°ì •ë¡ ì  fuzzing algorithmì„ ì œì‹œí•œë‹¤.</li>
<li>binary searchë¥¼ ì´ìš©í•˜ì—¬ counting oracleì„ ì‚¬ìš©</li>
<li>input spaceê°€ ì—¬ëŸ¬ ë°”ì´íŠ¸ë¥¼ í¬í•¨í•˜ê¸° ë•Œë¬¸ì— ë°˜ìœ¼ë¡œ ë‚˜ëˆˆë‹¤ëŠ”ê²ƒì´ ì• ë§¤í•  ìˆ˜ ìˆìŒ (ex [0, 255]*[0, 255]ì˜ 2byteì˜ ê²½ìš° ìˆ˜ì§, ìˆ˜í‰ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆìŒ)</li>
<li>ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•˜ì—¬ flattingì„ ì‚¬ìš©í•¨ &gt; [(0, 0), (0, 1), ..., (0, 255), (1,0), (1, 1), ... (255, 255)]</li>
<li>ì´ ì•Œê³ ë¦¬ì¦˜ì€ O(log(N))ì˜ execution complexityë¥¼ ê°€ì§€ë©° lower boundì— í•´ë‹¹</li>
</ul>
<p><img src="./image/11_algorithm4.png" alt="algorithm4"></p>
<h3 id="233-optimal-randomized-fuzzer">2.3.3. Optimal Randomized Fuzzer</h3>
<ul>
<li>ìœ„ì˜ ê²°ì •ë¡ ì  ì•Œê³ ë¦¬ì¦˜ì€ ì´ë¡ ì  lower boundë¥¼ ë‹¬ì„±í•˜ì§€ë§Œ noiseê°€ ì—†ëŠ” counting oralceì„ êµ¬í˜„í•˜ëŠ”ê²ƒì´ íš¨ìœ¨ì ì´ì§€ ì•ŠìŒ</li>
<li>noisy binary searchëŠ” ë¹„êµê°€ ë¯¿ì„ ìˆ˜ ì—†ë‹¤ëŠ” ê°€ì • í•˜ì— binary searchë¥¼ ìˆ˜í–‰í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©</li>
<li>ë†’ì€ í™•ë¥ ë¡œ ì„±ê³µí•˜ë˜ ì†Œìˆ˜ì˜ queryë¥¼ ìš”êµ¬í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ê°œë°œí•˜ëŠ”ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.</li>
<li>ê¸°ëŒ€ ê°’ì€ ëª¨ë“  ì ì¬ì ì¸ í–‰ë™ì„ ê³ ë ¤í•˜ë©° input ë¶„í¬ì— ëŒ€í•œ ê°€ì •ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
<li>ì¼ì • í™•ë¥ ë¡œ ì„±ê³µí•  ìˆ˜ ìˆëŠ” ì•Œê³ ë¦¬ì¦˜ë„ ì—¬ëŸ¬ë²ˆ ì‹¤í–‰ëœë‹¤ë©´ ì§€ìˆ˜ì ìœ¼ë¡œ ê°ì†Œí•˜ì—¬ ì‘ì€ ê°’ì´ ëœë‹¤.</li>
<li>ìš°ë¦¬ëŠ” <em>Ben-Or</em>ì´ ì œì•ˆí•œ noisy binary searchë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.</li>
</ul>
<h4 id="theorem-22-algorithm-1-execution-complexity">Theorem 2.2 (Algorithm 1 Execution Complexity)</h4>
<p>ì¿¼ë¦¬ë‹¹ p&lt;0.5ì˜ í™•ë¥ ë¡œ ì‹íŒ¨í•˜ëŠ” c=1 bitë¥¼ ë°˜í™˜í•˜ëŠ” noisy counting oracleì˜ ê²½ìš° ì ì–´ë„ 1-ğ›¿ í™•ë¥ ë¡œ ì„±ê³µí•˜ëŠ” O((1-ğ›¿)*$log(N)\over{(0.5-p^2)}$)ì˜ execution complexityë¥¼ ê°–ëŠ”ë‹¤.</p>
<h4 id="theorem-23-algorithm-1-optimality">Theorem 2.3 (Algorithm 1 Optimality)</h4>
<p>ìœ„ì˜ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì–´ë–¤ fuzzing algorithmë„ ë™ì¼í•œ execution complexityë¥¼ ê°–ëŠ”ë‹¤.</p>
<p><img src="./image/11_algorithm1.png" alt="algorithm1"></p>
<ul>
<li>queryì— ë”°ë¼ì„œ ë” ë§ì€ input spaceì— ê°€ì¤‘ì¹˜ (1-p)ë¥¼ ê³±í•¨, ì ì€ ì˜ì—­ì—ëŠ” pë¥¼ ê³±í•© &gt; ì´í›„ í•©ì´ 1ì´ë˜ë„ë¡ normalization</li>
<li>ê°€ì¤‘ì¹˜ê°€ í° ìœ ë§í•œ input spaceë‚´ì—ì„œ ë¶„í• ì„ ìš°ì„ ì‹œí•¨</li>
</ul>
<p>ì´ ì•Œê³ ë¦¬ì¦˜ì˜ íŠ¹ì§•</p>
<ol>
<li>noisy counting oracleì€ pê°€ ì¦ê°€í•¨ì— ì§€ìˆ˜ì ì´ ì•„ë‹Œ 2ì°¨í•­ìœ¼ë¡œ ì €í•˜ ëœë‹¤. &gt; ì´ëŠ” theorem2.3 ì—ì„œ ë³´ì˜€ë“¯ì´ ê°œì„ ë  ìˆ˜ ì—†ë‹¤.</li>
<li>input space Iì— ëŒ€í•´ ê³µê°„ë³µì¡ë„ê°€  O(log(N)ì´ë‹¤.</li>
</ol>
<h2 id="24-noisy-counting-oracle-through-monte-carlo-counting">2.4. Noisy Counting Oracle through Monte Carlo Counting</h2>
<ul>
<li>Monte Carlo countingì„ ê¸°ë°˜ìœ¼ë¡œ noisy counting oracleì„ ì„¤ê³„í•¨</li>
<li>graph structureì„ í™œìš©í•˜ì—¬ ê°œë³„ ê²½ë¡œì˜ í•©ìœ¼ë¡œ ë¶„í•´í•œë‹¤. ë˜í•œ ê°œë³„ ê²½ë¡œ ê³„ì‚°ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê·¼ì‚¬í•œë‹¤.</li>
</ul>
<h3 id="241-monte-carlo-counting">2.4.1. Monte Carlo Counting</h3>
<ul>
<li>ì¼ë°˜ì ì¸ Monte Carlo countingì„ ì‚¬ìš©í•œë‹¤ë©´ ëŒ€ë¶€ë¶„ì˜ ì˜ì—­ì— ëŒ€í•´ 0ìœ¼ë¡œ ê³„ì‚°ëœë‹¤.</li>
<li>|I| &gt;&gt; C(I)ì´ê¸° ë•Œë¬¸ì´ë‹¤.</li>
<li>0ìœ¼ë¡œ ì¶”ì •í•œ ê³„ì‚°ì„ ì‚¬ìš©í•œë‹¤ë©´ fuzzerì˜ ì„±ëŠ¥ì´ í¬ê²Œ ì €í•˜ë ê²ƒì´ë‹¤.</li>
</ul>
<h3 id="242-exploiting-cfg-structure-for-counting">2.4.2. Exploiting CFG Structure for Counting</h3>
<ul>
<li>CFGì˜ graph structureë¥¼ ì´ìš©í•œë‹¤ë©´ C(I)ë¥¼ ê°œë³„ ê²½ë¡œì˜ í•©ìœ¼ë¡œ ë¶„í•´í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<p><img src="./image/11_formula3.png" alt="formula3"></p>
<ul>
<li>í”„ë¡œê·¸ë¨ì—ì„œ ê²½ë¡œì˜ ìˆ˜ê°€ ë§ê¸° ë•Œë¬¸ì— ì´ í•©ì„ ì •í™•í•˜ê²Œ ê³„ì‚°í•  ìˆ˜ ì—†ì§€ë§Œ íš¨ìœ¨ì ìœ¼ë¡œ ê·¼ì‚¬ ê°€ëŠ¥í•˜ë‹¤.</li>
<li>ê°œë³„ ê²½ë¡œì— ëŒ€í•œ countë¡œ ê·¼ì‚¬ëœ countì„ ì¶”ì¸¡í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<p>Efficiently Approximating Individual Path Counts : uniconstraint countë¥¼ ì‚¬ìš©í•œë‹¤. ë˜í•œ ê³„ì‚°ì´ ì–´ë ¤ìš´ ë‘ê°€ì§€ ìš°í˜•ì˜ uniconstraint countì— ëŒ€í•´ ì„¤ëª…í•œë‹¤.</p>
<h3 id="243-approximating-path-counts">2.4.3. Approximating Path Counts</h3>
<ul>
<li>$C_\pi(I)$ë¥¼ ê³„ì‚°í•˜ê³ ì í•¨</li>
<li>ì´ëŠ” ì—¬ëŸ¬ ë‹¨ì¼ brach constraintë¥¼ ë§Œì¡±í•˜ëŠ” input set $I_{E_i}$ì˜ êµì§‘í•©</li>
</ul>
<p><img src="./image/11_formula4.png" alt="formula4"></p>
<ul>
<li>ì¦‰ ìµœì†Œ countë¥¼ í†µí•˜ì—¬ upper boundë¥¼ ì •í•  ìˆ˜ ìˆìŒ</li>
</ul>
<h3 id="244-uniconstraint-counts">2.4.4. Uniconstraint Counts</h3>
<ul>
<li>$C(I_{E_i})$ëŠ” $E_i$ì˜ ë‹¨ì¼ branch constraintë¥¼ ë§Œì¡±í•˜ëŠ” inputì˜ ìˆ˜ë¥¼ ì˜ë¯¸ &gt; uniconstraint count ë¼ê³  ë¶€ë¦„</li>
<li>Monte Carlo countingì„ í†µí•´ uniconstraint countë¥¼ ê·¼ì‚¬í•  ìˆ˜ ìˆìŒ &gt; ë‹¨ì¼ branch constraintê°€ ì—¬ëŸ¬ branch constraintì˜ êµì§‘í•©ì— ë¹„í•´ countê°€ ë” í´ ê°€ëŠ¥ì„±ì´ ë†’ê¸° ë•Œë¬¸</li>
</ul>
<p><img src="./image/11_formula5.png" alt="formula5"></p>
<p>r : Ië¥¼ ë¬´ì‘ìœ„ë¡œ ì„ì–´ì„œ ì¶”ì¶œí•œ ë¶€ë¶„ ì§‘í•©ì—ì„œ $E_i$ ë¶„ê¸° ì œì•½ì„ ë§Œì¡±í•˜ëŠ” ë¹„ìœ¨</p>
<h3 id="245-challenges-in-approximating-uniconstraint-counts">2.4.5. Challenges in Approximating Uniconstraint Counts</h3>
<ul>
<li>uniconstraint countingì€ naive Monte Carlo countingì„ìœ¼ë¡œ ê·¼ì‚¬í•˜ê¸° ì‰½ì§€ë§Œ ì–´ë ¤ìš´ ë‘ê°€ì§€ ìœ í˜•ì´ ì¡´ì¬í•œë‹¤.</li>
</ul>
<ol>
<li>ì¼ë¶€ single branch constraintëŠ” ì†Œìˆ˜ì˜ executionì—ì„œ ì˜ëª» í‰ê°€ë  ìˆ˜ ìˆë‹¤.C1</li>
<li>ì¤‘ì²©ëœ branchì—ì„œ í‰ê°€ë  ìˆ˜ ì—†ë‹¤.</li>
</ol>
<ul>
<li>naiveí•œ MCCëŠ” ì´ì™€ ê°™ì€ ê²½ìš° count = 0 ìœ¼ë¡œ íŒë‹¨</li>
<li>ì´ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•˜ì—¬ program executionì„ ëŠ˜ë¦´ ìˆ˜ ìˆì§€ë§Œ 2.2ì ˆì—ì„œ ì–¸ê¸‰ê³¼ ê°™ì´ ì¼ì •ìˆ˜ì˜ í”„ë¡œê·¸ë¨ì„ ë‚´ë¶€ì ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤. &gt; ìš°ë¦¬ê°€ ì‚¬ì „ì— ì–¼ë§ˆë‚˜ ë§ì€ ìˆ˜ì˜ ì‹¤í–‰ì´ í•„ìš”í•œì§€ ì•Œ ìˆ˜ ì—†ê¸°ì— ë¶ˆê°€ëŠ¥</li>
</ul>
<h3 id="246-c1-handling-evaluated-but-unsatisifed-branches">2.4.6. C1: Handling Evaluated but Unsatisifed Branches</h3>
<ul>
<li>Cheby-shev inequalityë¥¼ ì‚¬ìš©í•˜ì—¬ concentration boundë¥¼ ì‚¬ìš©í•˜ì—¬ uniconstraint countsì— ëŒ€í•œ í™•ë¥ ì  upper boundë¥¼ ê³„ì‚°í•¨</li>
<li>í”„ë¡œê·¸ë¨ ì‹¤í–‰ ë™ì•ˆ branch distanceì˜ í‰ê· , ë¶„ì‚°ì„ í†µí•˜ì—¬ branch constraintë¥¼ ë§Œì¡±ì‹œí‚¬ í™•ë¥  rì„ ì„¤ì •í•¨</li>
<li>uniconstraint count ìì²´ê°€ upper boundì´ê¸° ë•Œë¬¸ì— Chebt-shevì—ì„œë„ ìƒí•œì„ ì‚¬ìš©í•˜ëŠ”ê²ƒì€ ê´œì°®ìŒ</li>
</ul>
<p><img src="./image/11_table1.png" alt="table1"></p>
<ul>
<li>branch constraintì— ë”°ë¼ rì„ ê³„ì‚°í•˜ëŠ” ë°©ë²• &gt; ì˜¤ì°¨ê°€ ì‹¤í–‰ íšŸìˆ˜ kì— ëŒ€í•´ $1\over{e^k}$ë¡œ ê°ì†Œí•˜ê¸° ë•Œë¬¸ì— ìœ íš¨í•œ ê·¼ì‚¬</li>
<li>ì´ëŸ¬í•œ ìƒí•œì€ true countì—ì„œ overapproximation errorë¥¼ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ í•œë²ˆë„ ë§Œì¡±ë˜ì§€ ì•ŠëŠ” ë¶„ê¸°ì—ì„œë§Œ ì‚¬ìš©</li>
<li>ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ branchë¥¼ ë§Œì¡±í•˜ëŠ” inputì˜ ìˆ˜ì™€ ì´ inputì˜ ìˆ˜ ì‚¬ì´ì˜ ë¹„ìœ¨ì„ ì‚¬ìš©</li>
</ul>
<h3 id="247-c2-handling-unevaluated-nested-branches">2.4.7. C2: Handling Unevaluated Nested Branches</h3>
<ul>
<li>ì™¸ë¶€ì˜ constraintë¥¼ ë§Œì¡±í•˜ì§€ ì•Šë”ë¼ë„ ë‚´ë¶€ì˜ branchë¥¼ ë°©ë¬¸í•˜ê³  í‰ê°€í•˜ë„ë¡ í•˜ëŠ” <em>Monte Carlo Execution</em></li>
<li>í•œë²ˆì˜ ì‹¤í–‰ìœ¼ë¡œ ëª¨ë“  branchë¥¼ ë°©ë¬¸í•˜ì—¬ í‰ê°€í•¨ &gt; ì ì€ ì‹¤í–‰ìœ¼ë¡œ ëª¨ë“  ë¶„ê¸°ì˜ uniconstraint countsë¥¼ ê·¼ì‚¬ ê°€ëŠ¥</li>
<li>Monte Carlo Executionì€ runtimeì— control-flowë¥¼ ìˆ˜ì •í•˜ì—¬ inputê³¼ ê´€ê³„ì—†ì´ ëª¨ë“  ë¶„ê¸°ë¥¼ ë°©ë¬¸í•˜ë„ë¡ í•¨</li>
<li>inputì´ $\pi$ì˜ ëª¨ë“  branch constraintë¥¼ ë§Œì¡±í•˜ëŠ” ê²½ìš° &gt; ì¼ë°˜ì ì¸ ì‹¤í–‰</li>
<li>branch constraintì¤‘ í•˜ë‚˜ë¼ë„ ë§Œì¡±í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì›ë˜ pathì—ì„œ ë²—ì–´ë‚¨</li>
<li>í•­ìƒ sequential odering of computionì„ ìœ ì§€</li>
<li>ì›í•˜ëŠ” branchë¥¼ ë°©ë¬¸í•˜ëŠ”ê²ƒì„ ë³´ì¥í•˜ê¸° ìœ„í•˜ì—¬ program exceptionì„ ì¡°ì •í•´ì•¼í•¨</li>
</ul>
<blockquote>
<p>inputì´ array indexë¥¼ ì¡°ì ˆí•œë‹¤ê³  í•˜ì˜€ì„ë•Œ ë²”ìœ„ ë°–ì˜ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŒ &gt; instruction pointerë¥¼ ì§„í–‰ì‹œí‚¤ê³  ì½ì–´ì˜¤ëŠ” ê°’ì„ ë¬´ì‘ìœ„ ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤.</p>
</blockquote>
<ul>
<li>ì´ì™€ ê°™ì€ ì„¤ê³„ëŠ” ì½ì–´ì˜¤ëŠ” ê°’ì— ëŒ€í•œ ì§‘í•©ã…‡ë¥´ ì¦ê°€ì‹œí‚¤ì§€ë§Œ countì— ëŒ€í•œ ìƒí•œì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ê´œì°®ë‹¤.</li>
<li>memory read, writeê°„ì˜ ì˜ì¡´ì„±ì„ ì¼ì–´ë²„ë¦¬ì§€ë§Œ overheadê°€ ë‚®ë‹¤. <a href="#43-rq3-performance-overhead">4.3ì ˆ</a></li>
</ul>
<p><img src="./image/11_algorithm2.png" alt="algorithm2"></p>
<h3 id="248-efficiently-approximating-the-summation">2.4.8. Efficiently Approximating The Summation</h3>
<ul>
<li>ì´ì œê¹Œì§€ëŠ” targetìœ¼ë¡œì˜ ë‹¨ì¼ pathë§Œ ê³ ë ¤ &gt; ê° pathì˜ countì˜ í•© : formula 3</li>
<li>pathê°€ ë§ì€ ê²½ìš° oracle queryë§ˆë‹¤ ê° pathì— ëŒ€í•œ ê³„ì‚°ì€ ì–´ë ¤ì›€</li>
<li>pathë³„ë¡œ ë”í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê°€ì¥ í° countë¡œ ê·¼ì‚¬í•¨ &gt; ê°€ì¥ í° countë¥¼ ê°–ëŠ” ê²½ë¡œë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì€ ë‹¤ë¥¸ pathì— ë¹„í•´ í•©ì„ ê°€ì¥ ì˜ ë³´ì¡´í•¨</li>
<li>í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ì–´ë–¤ pathê°€ ê°€ì¥ í° countë¥¼ ê°–ëŠ”ì§€ ì‚¬ì „ì— ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì´ˆê¸°ì— ê° ê²½ë¡œì˜ ê°œë³„ countë¥¼ ê·¼ì‚¬í•˜ëŠ” ì¼ë¶€ ê³„ì‚°ì„ ìˆ˜í–‰ &gt; í•˜ì§€ë§Œ ê·¼ì‚¬ ì˜¤ë¥˜ë¡œ ì¸í•œ ë¶ˆí™•ì‹¤ì„± ì¡´ì¬</li>
</ul>
<p><img src="./image/11_algorithm3.png" alt="algorithm3"></p>
<ul>
<li>ë¶ˆí™•ì‹¤ì„±ì„ í¬ì°©í•˜ê¸° ìœ„í•˜ì—¬ multi-armed bandit literatureì—ì„œ ì‚¬ìš©í•œ ì†Œìˆ˜ì˜ ëŒ€ì•ˆ ê²½ë¡œë¥¼ íƒìƒ‰í•˜ê¸° ìœ„í•œ ìˆ˜ì • ê³„ìˆ˜ $\sqrt{log(t)\over{T_\pi}}$ ë¥¼ ì‚¬ìš© &gt; $T_\pi$ëŠ” të²ˆì§¸ query ì´ì „ì— $\pi$ê°€ ì„ íƒëœ íšŸìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„</li>
<li>PathCacheë¼ê³  ë¶ˆë¦¬ëŠ” ìºì‹œ êµ¬ì¡°ë¥¼ ì´ìš©í•˜ì—¬ ê°€ì¥ ìµœê·¼ì˜ count ì •ë³´ë¥¼ ì¶”ì </li>
</ul>
<h1 id="3-implementation">3. Implementation</h1>
<h2 id="31-toolchain">3.1. Toolchain</h2>
<ul>
<li>algorithm 1,2,3ì€ Cì–¸ì–´ë¡œ êµ¬í˜„í•¨ &gt; LLVM instrumentation, signal handlerë¥¼ ì‚¬ìš©í•˜ì—¬ algorithm 2 ì²˜ë¦¬</li>
<li><em>AFLGo</em>ì™€ ê°™ì€ forkserver ì‚¬ìš©</li>
<li>algorithm 3:19ì—ì„œ kì˜ ê°’ì„ 5ë¡œ ì„¤ì • (1/e^5 &lt; 0.01) &gt; algorithm 1ì˜ pê°’ì„ 0.01</li>
</ul>
<h2 id="32-reducing-loop-overheads">3.2. Reducing Loop Overheads</h2>
<ul>
<li>loopë¥¼ ì‚¬ìš©í•˜ë©´ ë™ì¼í•œ branchë¥¼ ì—¬ëŸ¬ë²ˆ ë°©ë¬¸í•¨ &gt; ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•˜ì—¬ ë°©ë¬¸ê°„ ì •ë³´ë¥¼ ê³µìœ í•¨</li>
<li>ë‹¨ì¼ MCEì—ì„œ branchê°€ ì—¬ëŸ¬ë²ˆ ë°©ë¬¸ëœë‹¤ë©´ ê° ë°©ë¬¸ì—ì„œ branch distanceëŠ” í‰ê· ê³¼ ë¶„ì‚°ì— ê¸°ì—¬í•¨ (streaming mean)</li>
<li>ê° branchë§ˆë‹¤ count ì •ë³´ë¥¼ ì¶”ê°€í•˜ì—¬ runtimeì— ì—¬ëŸ¬ ë°©ë¬¸ì— ê±¸ì¹œ control-flowë¥¼ ê°•ì œí•œë‹¤.</li>
</ul>
<h2 id="33-assigning-a-total-order">3.3. Assigning A Total Order</h2>
<ul>
<li>input spaceë¥¼ ì‚¬ì „ ìˆœìœ¼ë¡œ ë¶„í• í•¨ &gt; ì´ëŠ” input spaceì˜ ì–´ë–¤ ì˜ì—­ì´ë‹¨ countsë¥¼ ë³€ê²½í•  ê°€ëŠ¥ì„±ì´ ë™ë“±í•˜ë‹¤ëŠ” ê°€ì •</li>
<li>ì‹¤ì œ í”„ë¡œê·¸ë¨ì—ì„œëŠ” ë™ë“±í•˜ì§€ ì•Šë‹¤ëŠ” ì‹¤í—˜ì  ì¦ê±°ë¡œ ì¸í•´ ìœ íš¨í•˜ì§€ ì•ŠìŒ</li>
<li>ë”°ë¼ì„œ ì‚¬ì „ìˆœì´ ì•„ë‹Œ noisy counting oracleì—ì„œ ê´€ì°°ëœ program executionì„ ê¸°ë°˜ìœ¼ë¡œ ìˆœì„œë¥¼ í• ë‹¹í•¨</li>
<li>byte index setìœ¼ë¡œ ì‹œì‘í•˜ì—¬ 2ê°œì˜ ì§‘í•©ìœ¼ë¡œ ë¶„í• í•˜ê³  ê° ë¶€ë¶„ì§‘í•©ì— ëŒ€í•´ indexì— ëŒ€í•œ byteê°’ì„ ë³€í˜•í•˜ë©° MCEë¥¼ ìˆ˜í–‰</li>
<li>countê°€ ë³€ê²½ë˜ê±°ë‚˜ ë‹¨ì¼ byte indexê°€ ë‚¨ì„ë•Œê¹Œì§€ ì´ë¥¼ ë°˜ë³µ</li>
<li>ê° byte indexê°€ countë¥¼ ì–¼ë§ˆë‚˜ ì¦ê°€ì‹œí‚¤ëŠ”ì§€ì— ë”°ë¼ ìˆœì„œë¥¼ í• ë‹¹í•¨</li>
</ul>
<blockquote>
<p>ë¶€ë¡ B : ì‚¬ì „ìˆœì— ë¹„í•´ì„œ í‰ê·  210, ì¤‘ì•™ê°’ 54ë°° ë¹ ë¦„</p>
</blockquote>
<h2 id="34-preprocessing">3.4. Preprocessing</h2>
<ul>
<li>ëª©í‘œì— ë„ë‹¬í•˜ëŠ” ëª¨ë“  path setì„ êµ¬í•´ì•¼í•¨ &gt; ì‹¤ì œ CFGì—ì„œ ë„ˆë¬´ ë¹„ì‹¼ runtimeì„ ìš”êµ¬</li>
<li>pathì˜ subsetì„ ìƒì„±í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì€ ë°˜ë³µëœ edgeì˜ ê²½ë¡œë¥¼ ìƒì„±í•˜ì§€ ì•Šì•„ì„œ loop cjfl qnfrk</li>
<li>ìš°ë¦¬ëŠ” ì´ˆê¸° seed corpusë¥¼ ì‚¬ìš©í•˜ì—¬ path setì„ bootstrapí•¨</li>
<li>ëª©í‘œì— ê°€ê¹Œìš´ seedë¥¼ ì‹¤í–‰í•˜ê³  í•´ë‹¹ pathë¥¼ ë”°ë¼ branchë¥¼ ë¬´ì‘ìœ„ë¡œ ë³€í˜•í•˜ì—¬ ëª©í‘œì— ë„ë‹¬í•˜ëŠ” path setì„ ìƒì„±í•¨</li>
<li>pathê°€ ë°˜ì „ëœ í›„ì˜ í”„ë¡œê·¸ë¨ ì‹¤í–‰ì„ ê¸°ë°˜ìœ¼ë¡œ pathë¥¼ ìƒì„±í•¨</li>
<li>ë‹¤ë¥¸ DGFì™€ MC2ì˜ ì „ì²˜ë¦¬ ê³¼ì •ì— ê±¸ë¦¬ëŠ” ì‹œê°„ì´ ë¹„ìŠ·í•¨</li>
</ul>
<h2 id="35-randomly-generating-inputs">3.5. Randomly Generating Inputs</h2>
<ul>
<li>input spaceë¥¼ dì°¨ì› hyper rectangleë¡œ í‘œí˜„í•¨, dê°œì˜ êµ¬ê°„ìœ¼ë¡œ ì¸ì½”ë”© ë˜ë©° ê° êµ¬ê°„ì€ ì°¨ì›ë‹¹ inputì˜ lower, upper boundë¥¼ ë‚˜íƒ€ëƒ„</li>
<li>ìš°ë¦¬ëŠ” hyper rectangleì—ì„œ kê°œì˜ inputì„ ë¬´ì‘ìœ„ë¡œ ì„ íƒí•˜ê¸° ìœ„í•˜ì—¬ dê°œì˜ ì •ìˆ˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ìƒì„±</li>
<li>ì´ˆê¸° ì‹œë“œê°€ hyper rectangleì— ì†í•˜ëŠ” ê²½ìš° initial seed corpus ì •ë³´ë¥¼ ë” ì˜ í™œìš©í•˜ê¸° ìš°ã…ã…ì—¬ kê°œì˜ ì…ë ¥ì¤‘ ì¼ë¶€ë¡œ ì‚¬ìš©í•¨</li>
<li>seed corpusë¥¼ ì¶”ì í•˜ëŠ”ê²ƒì´ ì•„ë‹Œ group = (hyper rectangle, weight) íŠœí”Œì„ ì¶”ì </li>
<li></li>
</ul>
<h1 id="4-evaluation">4. Evaluation</h1>
<ol>
<li>ë‹¤ë¥¸ ìµœì‹  DGFì™€ ë¹„êµ</li>
<li>ì‹¤ì œ ë²„ê·¸ë¥¼ ì°¾ì„ ìˆ˜ ìˆëŠ”ê°€?</li>
<li>ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ</li>
<li>design choiceê°€ ì •ë‹¹í•œê°€?</li>
</ol>
<h2 id="41-rq1-fuzzers-comparison">4.1. RQ1: Fuzzers Comparison</h2>
<ul>
<li>benchmark : magma, AFLGoì˜ Fuzzer Test suite</li>
<li>baseline : AFLGo, ParmeSan</li>
<li>setup : Magma = TTE, Fuzzer Test suite : TTT, timeout = 6hr, 20íšŒ</li>
</ul>
<h3 id="411-magma-results">4.1.1. Magma Results</h3>
<p><img src="./image/11_table2.png" alt="table2"></p>
<h3 id="412-case-study">4.1.2. Case Study</h3>
<p><img src="./image/11_figure2.png" alt="figure2"></p>
<ul>
<li>MC2ì—ì„œë§Œ ë°œê²¬ëœ PNG001</li>
<li><code>width=0x55555555</code>, <code>channels=3</code>ì¼ë•Œ <code>row_factor</code>ê°€ 0ì´ ë˜ì–´ì„œ divide by zeroë¥¼ ë°œìƒ</li>
<li>AFLGoëŠ” í•´ë‹¹ íŠ¹ì • ê°’ì„ ìƒì„±í•  í™•ë¥ ì´ ë‚®ìŒ</li>
<li>ParmeSanì€ ì¤‘ì²©ëœ ì¡°ê±´ (6, 7) í–‰ì„ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì§€ ëª»í•¨</li>
</ul>
<h3 id="413-fuzzer-test-suite-results">4.1.3. Fuzzer Test Suite Results</h3>
<p><img src="./image/11_table3.png" alt="table3"></p>
<blockquote>
<p>Result : í‰ê·  134, ì¤‘ì•™ê°’ 38ë°° ì„±ëŠ¥ í–¥ìƒ, AFLGo(12)ë³´ë‹¤ ë§ì€ 28ê°œì˜ ë²„ê·¸ë¥¼ ì°¾ìŒ</p>
</blockquote>
<h2 id="42-rq2-bug-finding">4.2. RQ2: Bug Finding</h2>
<p><img src="./image/11_table4.png" alt="table4"></p>
<p><img src="./image/11_table5.png" alt="table5"></p>
<ul>
<li>Undefined Behavior Sanitizerë¥¼ ì‚¬ìš©í•˜ì—¬ target butë¥¼ ì‹ë³„</li>
<li>AFL-CMinìœ¼ë¡œ ì¤‘ë³µ ì œê±°</li>
</ul>
<blockquote>
<p>Result : 49ê°œì˜ ìƒˆë¡œìš´ bug ì°¾ìŒ</p>
</blockquote>
<h2 id="43-rq3-performance-overhead">4.3. RQ3: Performance Overhead</h2>
<p><img src="./image/11_table6,7.png" alt="table6,7"></p>
<ul>
<li>Monte Carlo Executionì˜ performance overheadë¥¼ ì¸¡ì •í•¨</li>
<li>MC2ì˜ ë°ì´í„° êµ¬ì¡° )PathCache)ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¶”ì </li>
</ul>
<blockquote>
<p>Result : instrumentatioì—ì„œ 30% runtime, 4% memory, native executionì— ë¹„í•´ 105% runtime, 16% memory overhead</p>
</blockquote>
<h2 id="44-rq4-design-choices">4.4. RQ4: Design Choices</h2>
<p><img src="./image/11_table8,9.png" alt="table8,9"></p>
<ul>
<li>ê° design choiceì˜ ì˜í–¥ì„ ì¸¡ì •</li>
</ul>
<h3 id="441-chebyshevs-inequality-for-uniconstraint-counts">4.4.1 Chebyshevâ€™s Inequality for Uniconstraint Counts</h3>
<ul>
<li>Rule-Of-3, Good-Turingì„ ì ìš©í•˜ì—¬ ì‹¤í—˜ &gt; ê²°ê³¼ Table 8 &gt; MC2ì˜ Chebyshev's inequalityëŠ” íš¨ê³¼ì </li>
</ul>
<h3 id="442-minimum-uniconstraint-count">4.4.2 Minimum Uniconstraint Count</h3>
<ul>
<li>ìµœì†Œ uniconstraint count  vs ëª¨ë“  constraintì˜ ê³± &gt; ê²°ê³¼ table 9</li>
</ul>
<h3 id="443-path-selection">4.4.3 Path Selection</h3>
<p><img src="./image/11_table10.png" alt="table10"></p>
<ul>
<li><a href="#248-efficiently-approximating-the-summation">ê°€ì¥ í° countë¥¼ ê°–ëŠ” pathë¥¼ ì„ íƒí• ë•Œ</a> ì˜ multi-armed banditì´ ì•„ë‹Œ greedy, epsilon-greedyë¥¼ ì ìš©í•˜ì—¬ ë¹„êµ &gt; ê²°ê³¼ table 10</li>
</ul>
<h1 id="5-related-work">5. Related Work</h1>
<h2 id="51-approximate-counting">5.1. Approximate Counting</h2>
<ul>
<li>SAT formulaì˜ í•´ë¥¼ countingí•˜ëŠ” ê²ƒì€ ë§ì€ ê³³ì—ì„œ ì‚¬ìš©ëœë‹¤.</li>
<li>Approximat Countingì€ Monte Carlo ë¿ë§Œ ì•„ë‹ˆë¼ ë§ì€ ë¶„ì•¼ì—ì„œ ì‚¬ìš©ë¨</li>
<li>ìµœê·¼ì—” CGFë¥¼ ìœ„í•œ seed schedulingì—ì„œë„ ì‚¬ìš©ë¨, graph centralityë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰ ê°€ëŠ¥í•œ edgeì˜ ìˆ˜ë¥¼ ê·¼ì‚¬í•¨</li>
<li>MC2(DGF)ë¥¼ CGFë¡œ ì¼ë°˜í™” í•  ì—°êµ¬ í•„ìš”</li>
</ul>
<h2 id="52-directed-greybox-fuzzing">5.2. Directed Greybox Fuzzing</h2>
<ul>
<li>MC2ëŠ” distanceê°€ ì•„ë‹Œ noisy binary seachê³¼ aproximate countingì„ í†µí•˜ì—¬ guideí•¨</li>
</ul>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$']]},
    messageStyle: "none",
    "HTML-CSS": { availableFonts: "TeX", preferredFont: "TeX" },
  });
</script>
</body>
</html>
